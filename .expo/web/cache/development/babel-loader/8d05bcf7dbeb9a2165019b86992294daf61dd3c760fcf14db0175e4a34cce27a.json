{"ast":null,"code":"var _jsxFileName = \"/media/pierrot-3112/08DE3CDADE3CC22C/dev/Mobile/VoieRapide/app/screens/Login.tsx\";\nimport React, { useState } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ImageBackground from \"react-native-web/dist/exports/ImageBackground\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAuth } from '../context/AuthContext';\nimport { useNavigation } from \"@react-navigation/native\";\nimport styles from '../../styles/Login.style';\nimport useNetworkStatus from '../../components/NetworkStatus/NetworkStatus';\nimport Toast from 'react-native-toast-message';\nimport PullToRefresh from '../../components/PullToRefresh';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Login = () => {\n  const [num_tel, setNumTel] = useState('');\n  const [password, setPassword] = useState('');\n  const [secureText, setSecureText] = useState(true);\n  const [loading, setLoading] = useState(false);\n  const {\n    onLogin,\n    getRole\n  } = useAuth();\n  const navigation = useNavigation();\n  const isOnline = useNetworkStatus();\n  const togglePasswordVisibility = () => setSecureText(!secureText);\n  const handleRefresh = async () => {\n    setNumTel('');\n    setPassword('');\n  };\n  const login = async () => {\n    if (!num_tel || !password) {\n      Toast.show({\n        type: 'error',\n        text1: 'Tous les champs sont obligatoires',\n        text2: 'Veuillez réessayer!'\n      });\n      return;\n    }\n    setLoading(true);\n    try {\n      const result = await onLogin(num_tel, password);\n      if (result?.error) {\n        Toast.show({\n          type: 'error',\n          text1: 'Erreur de connexion',\n          text2: result.msg || 'Utilisateur inexistant ou mot de passe incorrect'\n        });\n      } else {\n        const role = await getRole(result.token);\n        if (role !== 'client') {\n          navigation.navigate('Home');\n        } else {\n          Toast.show({\n            type: 'error',\n            text1: 'Accès refusé',\n            text2: 'Vous n\\'avez pas les permissions nécessaires.'\n          });\n        }\n      }\n    } catch (error) {\n      Toast.show({\n        type: 'error',\n        text1: 'Erreur',\n        text2: 'Une erreur est survenue lors de la connexion.'\n      });\n    }\n    setLoading(false);\n  };\n  return _jsxDEV(PullToRefresh, {\n    onRefresh: handleRefresh,\n    children: _jsxDEV(SafeAreaView, {\n      children: _jsxDEV(KeyboardAvoidingView, {\n        style: styles.container,\n        children: [_jsxDEV(ImageBackground, {\n          source: require('../../assets/images/city.jpg'),\n          style: styles.head\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this), _jsxDEV(ImageBackground, {\n          source: require('../../assets/images/logoVoieRapide.jpeg'),\n          style: styles.logo\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 21\n        }, this), _jsxDEV(View, {\n          style: styles.title,\n          children: _jsxDEV(Text, {\n            style: styles.titleText,\n            children: \"Authentification\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 80,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 21\n        }, this), _jsxDEV(View, {\n          style: styles.formLogin,\n          children: [_jsxDEV(TextInput, {\n            style: styles.inputText,\n            placeholder: \"Num\\xE9ro de t\\xE9l\\xE9phone\",\n            onChangeText: setNumTel,\n            value: num_tel,\n            keyboardType: \"phone-pad\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 25\n          }, this), _jsxDEV(View, {\n            style: styles.inputPassword,\n            children: [_jsxDEV(TextInput, {\n              style: styles.input,\n              placeholder: \"Mot de passe\",\n              secureTextEntry: secureText,\n              onChangeText: setPassword,\n              value: password\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 29\n            }, this), _jsxDEV(TouchableOpacity, {\n              onPress: togglePasswordVisibility,\n              children: _jsxDEV(Ionicons, {\n                name: secureText ? \"eye-outline\" : \"eye-off-outline\",\n                size: 24,\n                color: \"gray\",\n                style: styles.icon\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 99,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 98,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 25\n          }, this), _jsxDEV(TouchableOpacity, {\n            style: styles.btnSubmit,\n            onPress: login,\n            disabled: loading,\n            children: _jsxDEV(Text, {\n              style: styles.btnSubmitText,\n              children: \"Se Connecter\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 103,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 25\n          }, this), loading && _jsxDEV(ActivityIndicator, {\n            size: \"large\",\n            color: \"#0000ff\",\n            style: {\n              marginTop: 10\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 105,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 74,\n    columnNumber: 9\n  }, this);\n};\nexport default Login;","map":{"version":3,"names":["React","useState","View","TextInput","TouchableOpacity","SafeAreaView","ImageBackground","Text","ActivityIndicator","KeyboardAvoidingView","Ionicons","useAuth","useNavigation","styles","useNetworkStatus","Toast","PullToRefresh","jsxDEV","_jsxDEV","Login","num_tel","setNumTel","password","setPassword","secureText","setSecureText","loading","setLoading","onLogin","getRole","navigation","isOnline","togglePasswordVisibility","handleRefresh","login","show","type","text1","text2","result","error","msg","role","token","navigate","onRefresh","children","style","container","source","require","head","fileName","_jsxFileName","lineNumber","columnNumber","logo","title","titleText","formLogin","inputText","placeholder","onChangeText","value","keyboardType","inputPassword","input","secureTextEntry","onPress","name","size","color","icon","btnSubmit","disabled","btnSubmitText","marginTop"],"sources":["/media/pierrot-3112/08DE3CDADE3CC22C/dev/Mobile/VoieRapide/app/screens/Login.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport { \n    View, TextInput, TouchableOpacity, SafeAreaView, \n    ImageBackground, Text, ActivityIndicator, KeyboardAvoidingView \n} from 'react-native';\nimport { Ionicons } from '@expo/vector-icons';\nimport { useAuth } from '../context/AuthContext';\nimport { useNavigation } from \"@react-navigation/native\";\nimport styles from '../../styles/Login.style';\nimport useNetworkStatus from '../../components/NetworkStatus/NetworkStatus';\nimport Toast from 'react-native-toast-message';\nimport PullToRefresh from '../../components/PullToRefresh'; \n\nconst Login = () => {\n    const [num_tel, setNumTel] = useState('');\n    const [password, setPassword] = useState('');\n    const [secureText, setSecureText] = useState(true);\n    const [loading, setLoading] = useState(false);\n    const { onLogin, getRole } = useAuth();\n    const navigation = useNavigation<any>(); \n    const isOnline = useNetworkStatus();\n\n    const togglePasswordVisibility = () => setSecureText(!secureText);\n\n    // Fonction de rafraîchissement\n    const handleRefresh = async () => {\n        // Réinitialiser les champs ou effectuer des actions de réinitialisation\n        setNumTel('');\n        setPassword('');\n    };\n\n    const login = async () => {\n        if (!num_tel || !password) {\n            Toast.show({ \n                type: 'error',\n                text1: 'Tous les champs sont obligatoires',\n                text2: 'Veuillez réessayer!'\n            });\n            return;\n        }\n\n        setLoading(true);\n        try {\n            const result = await onLogin(num_tel, password);\n            if (result?.error) {\n                Toast.show({\n                    type: 'error',\n                    text1: 'Erreur de connexion',\n                    text2: result.msg || 'Utilisateur inexistant ou mot de passe incorrect',\n                });\n            } else {\n                const role = await getRole(result.token);\n                if (role !== 'client') {\n                    navigation.navigate('Home');\n                } else {\n                    Toast.show({\n                        type: 'error',\n                        text1: 'Accès refusé',\n                        text2: 'Vous n\\'avez pas les permissions nécessaires.',\n                    });\n                }\n            }\n        } catch (error) {\n            Toast.show({\n                type: 'error',\n                text1: 'Erreur',\n                text2: 'Une erreur est survenue lors de la connexion.',\n            });\n        }\n        setLoading(false);\n    };\n\n    return (\n        <PullToRefresh onRefresh={handleRefresh}>\n            <SafeAreaView>\n                <KeyboardAvoidingView style={styles.container}>\n                    <ImageBackground source={require('../../assets/images/city.jpg')} style={styles.head} />\n                    <ImageBackground source={require('../../assets/images/logoVoieRapide.jpeg')} style={styles.logo} />\n                    <View style={styles.title}>\n                        <Text style={styles.titleText}>Authentification</Text>\n                    </View>\n                    <View style={styles.formLogin}>\n                        <TextInput\n                            style={styles.inputText}\n                            placeholder=\"Numéro de téléphone\"\n                            onChangeText={setNumTel}\n                            value={num_tel}\n                            keyboardType=\"phone-pad\"\n                        />\n                        <View style={styles.inputPassword}>\n                            <TextInput\n                                style={styles.input}\n                                placeholder=\"Mot de passe\"\n                                secureTextEntry={secureText}\n                                onChangeText={setPassword}\n                                value={password}\n                            />\n                            <TouchableOpacity onPress={togglePasswordVisibility}>\n                                <Ionicons name={secureText ? \"eye-outline\" : \"eye-off-outline\"} size={24} color=\"gray\" style={styles.icon} />\n                            </TouchableOpacity>\n                        </View>\n                        <TouchableOpacity style={styles.btnSubmit} onPress={login} disabled={loading}>\n                            <Text style={styles.btnSubmitText}>Se Connecter</Text>\n                        </TouchableOpacity>\n                        {loading && <ActivityIndicator size=\"large\" color=\"#0000ff\" style={{ marginTop: 10 }} />}\n                    </View>\n                </KeyboardAvoidingView>\n            </SafeAreaView>\n        </PullToRefresh>\n    );\n};\n\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{"hasCjsExports":false},"sourceType":"module","externalDependencies":[]}